"""
Copyright (c) 2022.
FileName: mytools.py
Brief: 抽象出一些基本操作制成的辅助工具。
Author: 青羽
Blog: https://chen-qingyu.github.io
CreateDate: 2022.09.06
"""

import turtle
import math


def my_range(start: float, stop: float, step: float = 1) -> list[float]:
    """
    range函数拓展版，支持range函数所有功能加上浮点数。

    :param start: start number
    :param stop: stop number
    :param step: step number
    :return: a list of floats
    """
    ls = []
    while (start < stop) if step > 0 else (start > stop):
        ls.append(start)
        start += step
    return ls


def init_environment(title: str, width: float, height: float) -> None:
    """
    初始化环境。

    :param title: 窗口标题
    :param width: 窗口宽度
    :param height: 窗口高度
    """
    # Initialize turtle heading: to the right (east), positive angles: counterclockwise
    turtle.mode("standard")
    # Initialize window title
    turtle.title(title)
    # Initialize window size
    turtle.setup(width, height)
    # Initialize back-grond color: light gray
    turtle.bgcolor("#F0F0F0")
    # Set the angle measurement units to radians, for convenience of mathematical calculation
    turtle.radians()
    # Hide the path
    turtle.penup()
    # Hide the turtle
    turtle.hideturtle()
    # Accelerate the drawing
    turtle.tracer(2)


def draw_rect(x: float, y: float, width: float, height: float, fillcolor: str, angle: float = 0) -> None:
    """
    画矩形。

    :param x: 左上角x坐标
    :param y: 左上角y坐标
    :param width: x方向宽度
    :param height: y方向高度
    :param fillcolor: 填充颜色
    :param angle: 偏转角度 (矩形水平线与x轴的夹角弧度)
    """
    turtle.goto(x, y)
    turtle.fillcolor(fillcolor)
    turtle.begin_fill()
    for i in range(4):
        turtle.setheading(angle + i * -math.pi / 2)
        turtle.forward(width if i % 2 == 0 else height)
    turtle.end_fill()


def draw_star(center: tuple[float, float], radius: float, fillcolor: str, angle: float = 0) -> None:
    """
    画五角星。

    :param center: 五角星外接圆圆心坐标
    :param radius: 五角星外接圆半径
    :param fillcolor: 填充颜色
    :param angle: 偏转角度 (五角星上顶点到中心的连线与y轴的夹角弧度)
    """
    turtle.goto(center[0] - radius * math.sin(angle), center[1] + radius * math.cos(angle))
    turtle.fillcolor(fillcolor)
    turtle.begin_fill()
    for i in range(5):
        turtle.setheading(-2 * math.pi / 5 * (1 + 2 * i) + angle)
        turtle.forward(radius * math.cos(math.pi / 10) * 2)
    turtle.end_fill()


def draw_circle(center: tuple[float, float], radius: float, fillcolor: str, extent: tuple[float, float] = (0, 2 * math.pi),
                steps: int = None) -> None:
    """
    画圆形或圆弧。

    :param center: 圆心坐标
    :param radius: 圆半径
    :param fillcolor: 填充颜色
    :param extent: 圆弧弧度
    :param steps: 分辨率
    """
    turtle.goto(center[0] + radius, center[1])
    turtle.setheading(math.pi / 2)
    turtle.circle(radius, extent[0])
    turtle.fillcolor(fillcolor)
    turtle.begin_fill()
    turtle.circle(radius, extent[1] - extent[0], steps)
    turtle.end_fill()


def draw_polygon(points: list[tuple[float, float]], fillcolor: str) -> None:
    """
    画多边形。

    :param points: 多边形顶点
    :param fillcolor: 填充颜色
    """
    turtle.goto(points[0][0], points[0][1])
    turtle.fillcolor(fillcolor)
    turtle.begin_fill()
    for i in range(len(points)):
        turtle.goto(points[i][0], points[i][1])
    turtle.end_fill()
